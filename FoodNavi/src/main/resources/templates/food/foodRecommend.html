<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<th:block th:insert="~{/includes/headerMain}"></th:block>
<meta charset="UTF-8">
<script th:inline="javascript">
	function foodRecord() {
		var food_name = $("#food_name").text();
		var food_score = $("#food_score").text();
		var amount = $("#amount").val();
		
		$.ajax({
            type: "POST",
            url: "/food_recommend_record",
            data: JSON.stringify({
                food_name: food_name,
                food_score: food_score,
                amount: amount
            }),
            contentType: "application/json",
            success: function(response) {
                alert("성공적으로 기록되었습니다.");
            },
            error: function(error) {
                alert("기록에 실패했습니다.");
            }
        });
	}
</script>
<h1><a href="/mainpage">FoodNavi</a></h1>
<!-- myChange -->
<article id="box">
    <h2 class="major">[[${userVo.user.name}]] 님을 위한 오늘의 식단</h2>
    <!--action 비워두도록 하겠습니다. 컨트롤러를 참고해서 넣어주세요.-->
    <form method="post" action="food_other_recommend">
        <div class="fields">
            <div class="field">
            <table>
            	<tr th:each="foodvo, iterStat : ${foodRecommendList}" th:if="${iterStat.index < 1}">
            		<td>
            			<!--DB에서 가져온 음식정보들-->
		                <h2 class="major">추천 음식</h2>
		                <!--#으로 되어있는 것들은 도메인에서 값을 불러와야합니다.-->
		                <label id="food_name" th:text="${foodvo.food.name}"></label>
            		</td>
            		<td>
	            		<h2 class="major">칼로리</h2>
	                	<p id="food_kcal" th:text="${foodvo.food.foodDetail.kcal}"></p>
            		</td>
            		<td>
	            		<h2 class="major">탄수화물</h2>
	                	<p id="food_carb" th:text="${foodvo.food.foodDetail.carb}"></p>
            		</td>
            		<td>
	            		<h2 class="major">단백질</h2>
	                	<p id="food_prt" th:text="${foodvo.food.foodDetail.prt}"></p>
            		</td>
            		<td>
	            		<h2 class="major">지방</h2>
	                	<p id="food_fat" th:text="${foodvo.food.foodDetail.fat}"></p>
            		</td>
            		<td>
	            		<h2 class="major">점수</h2>
	                	<p id="food_score" th:text="${foodvo.score}"></p>
            		</td>
            		<td>
            			<h2 class="major">수량</h2>
            			<input type="number" id="amount" name="amount" min="0" th:value="0">개
            		</td>
            		<td>
            			<h2 class="major">선택</h2>
            			<input type="button" value="기록하기" class="button" onclick="foodRecord()"/>
            		</td>
            	</tr>
            </table>
            </div>

        </div>
        <ul class="actions">
            <li><input type="submit" value="다른 음식 추천받기" class="button"/></li>
        </ul>
		<a href="/foodTodayHistory_view" class="button">기록 승인</a>
		<a href="/foodHistory_view" class="button">기록 확인</a>
        <a href="/foodRecommendation" class="button">이전</a>
        

    </form>
</article>

<th:block th:insert="~{includes/footer}"></th:block>